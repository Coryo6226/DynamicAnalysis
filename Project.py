#! /usr/bin/env python
#  -*- coding: utf-8 -*-
#
# GUI module generated by PAGE version 6.0.1
#  in conjunction with Tcl version 8.6
#    Apr 19, 2021 10:04:34 PM BST  platform: Windows NT

import sys
import r2pipe
import ctypes
import filecmp
import os
import os.path

try:
    import Tkinter as tk
except ImportError:
	import tkinter as tk
	from tkinter import filedialog
	from tkinter import simpledialog

try:
    import ttk
    py3 = False
except ImportError:
    import tkinter.ttk as ttk
    py3 = True

import Project_support

check = "yellow"

def is_admin():
    try:
        return ctypes.windll.shell32.IsUserAnAdmin()
    except:
        return False

if is_admin():
		def vp_start_gui():
			'''Starting point when module is the main routine.'''
			global val, w, root
			root = tk.Tk()
			top = Toplevel1 (root)
			Project_support.init(root, top)
			root.mainloop()

		w = None
		def create_Toplevel1(rt, *args, **kwargs):
			'''Starting point when module is imported by another module.
			   Correct form of call: 'create_Toplevel1(root, *args, **kwargs)' .'''
			global w, w_win, root
			#rt = root
			root = rt
			w = tk.Toplevel (root)
			top = Toplevel1 (w)
			Project_support.init(w, top, *args, **kwargs)
			return (w, top)

		def destroy_Toplevel1():
			global w
			w.destroy()
			w = None

		class Toplevel1:
			

				def myfunc():
						global file_path
						file_path = "null"
						#global check 
						#check = "red"
					
				myfunc()
				
				def PickFile(self):
					root = tk.Tk()
					root.withdraw()
					global file_path
					file_path = filedialog.askopenfilename()
					global r2
					r2 = r2pipe.open(file_path)
						
								
			#	def myproc():
			#		global r2
			#		r2 = r2pipe.open(file_path) # Open r2 with file
					
			
						
				
			#	myproc()	

				
				def DissasFile(self):
						if file_path != "null":
								r2.cmd('aaa')              # Analyze file
								r2.cmd('pdf @@f > outD.txt')     # Write disassembly for each function to out file                 
							

								with open ("outD.txt", 'r') as f:
									self.Display1.insert(1.0, f.read())	
						else:
									ctypes.windll.user32.MessageBoxW(0, "Please choose a file!", "ERROR", 0)
									
									
									
									
				def DebugFile(self):
					if file_path != "null":
							r2.cmd("doo")
							
					else:
						ctypes.windll.user32.MessageBoxW(0, "Please choose a file!", "ERROR", 0)
							
									
				
				
				
				def Breakpoint(self):
						if file_path != "null":
							Breakpoint = simpledialog.askstring(title="Breakpoint", prompt="Set Breakpoint")
							r2.cmd("doo")
							r2.cmd("db" + Breakpoint)
							
							
						#	with open ("outB.txt", 'r') as f:
						#		self.Display2.insert(1.0, f.read())
						else:
									ctypes.windll.user32.MessageBoxW(0, "Please choose a file!", "ERROR", 0)
					 
							
						
					
							
							
				def RegFile(self):
						global check
						if file_path != "null":
							
							if os.path.isfile("outR.txt"):   	#check if file exists
								filesize = os.path.getsize("outR.txt")
							
								if filesize == 0:
									r2.cmd('dr > outR.txt')
									with open ("outR.txt", 'r') as f:
										self.Display5.configure(foreground="black")
										self.Display1.insert(1.0, f.read())
									#os.remove("outR.txt")
									
								else: 
									r2.cmd('dr > OutR1.txt')
									
									with open ("outR1.txt", 'r') as f:
										self.Display5.configure(foreground="red")
										self.Display5.insert(1.0, f.read())
									
									os.remove("outR1.txt")
									os.remove("outR.txt")
							
							else:
								
								f = open("outR.txt", "x")
								filesize = os.path.getsize("outR.txt")
								if filesize == 0:
									r2.cmd('dr > outR.txt')
									
									with open ("outR.txt", 'r') as f:
										self.Display5.configure(foreground="black")
										self.Display5.insert(1.0, f.read())
									#os.remove("outR.txt")
									
								else: 
									r2.cmd('dr > OutR1.txt')
									check = "red"
									#os.remove("outR.txt")
									
									with open ("outR1.txt", 'r') as f:
										self.Display5.configure(foreground="yellow")
										self.Display5.insert(1.0, f.read())
									
									#os.remove("outR1.txt")
									#os.remove("outR.txt")
							

							
							
						#	with open ("outR.txt", 'r') as f:
							#		self.Display5.insert(1.0, f.read())	
						else:
										ctypes.windll.user32.MessageBoxW(0, "Please choose a file!", "ERROR", 0)	
									
									
					
									
				def MemFile(self):
						if file_path != "null":
						#	r2.cmd('aaa')              # Analyze file
							r2.cmd('dm > outM.txt')     # Write disassembly for each function to out file                 
							with open ("outM.txt", 'r') as f:
									self.Display4.insert(1.0, f.read())	
						else:
									ctypes.windll.user32.MessageBoxW(0, "Please choose a file!", "ERROR", 0)				
						
						
				def StackFile(self):
						if file_path != "null":
						#	r2.cmd('aaa')              # Analyze file
							r2.cmd('pxr @ esp > outS.txt')     # Write disassembly for each function to out file                 
							

							with open ("outS.txt", 'r') as f:
									self.Display3.insert(1.0, f.read())	
						else:
									ctypes.windll.user32.MessageBoxW(0, "Please choose a file!", "ERROR", 0)
			
			
			
							
				def contFile(self):
						if file_path != "null":
							#R2.cmd("doo")
							r2.cmd('dc > outC.txt')              # Analyze file
										  
							

							with open ("outC.txt", 'r') as f:
									self.Display2.insert(1.0, f.read())	
						else:
									ctypes.windll.user32.MessageBoxW(0, "Please choose a file!", "ERROR", 0)
									
									
				
				def ClearFile(self):

						self.Display1.delete("1.0", tk.END)
						self.Display2.delete("1.0", tk.END)
						self.Display3.delete("1.0", tk.END)
						self.Display4.delete("1.0", tk.END)
						self.Display5.delete("1.0", tk.END)
						
			
				def __init__(self, top=None):
					'''This class configures and populates the toplevel window.
					top is the toplevel containing window.'''
					_bgcolor = '#d9d9d9'  # X11 color: 'gray85'
					_fgcolor = '#000000'  # X11 color: 'black'
					_compcolor = '#d9d9d9' # X11 color: 'gray85'
					_ana1color = '#d9d9d9' # X11 color: 'gray85'
					_ana2color = '#ececec' # Closest X11 color: 'gray92'

					top.geometry("760x528+405+109")
					top.minsize(120, 1)
					top.maxsize(1540, 845)
					top.resizable(1,  1)
					top.title("New Toplevel")
					top.configure(background="#d9d9d9")
					top.configure(highlightbackground="#d9d9d9")
					top.configure(highlightcolor="black")

					self.FileBtn = tk.Button(top)
					self.FileBtn.place(relx=0.0, rely=0.0, height=24, width=47)
					self.FileBtn.configure(activebackground="#ececec")
					self.FileBtn.configure(activeforeground="#000000")
					self.FileBtn.configure(background="#d9d9d9")
					self.FileBtn.configure(disabledforeground="#a3a3a3")
					self.FileBtn.configure(foreground="#000000")
					self.FileBtn.configure(highlightbackground="#d9d9d9")
					self.FileBtn.configure(highlightcolor="black")
					self.FileBtn.configure(pady="0")
					self.FileBtn.configure(text='''File''')
					self.FileBtn.configure(command=self.PickFile);

					self.DissasBtn = tk.Button(top)
					self.DissasBtn.place(relx=0.053, rely=0.0, height=24, width=87)
					self.DissasBtn.configure(activebackground="#ececec")
					self.DissasBtn.configure(activeforeground="#000000")
					self.DissasBtn.configure(background="#d9d9d9")
					self.DissasBtn.configure(disabledforeground="#a3a3a3")
					self.DissasBtn.configure(foreground="#000000")
					self.DissasBtn.configure(highlightbackground="#d9d9d9")
					self.DissasBtn.configure(highlightcolor="black")
					self.DissasBtn.configure(pady="0")
					self.DissasBtn.configure(text='''Dissasemble''')
					self.DissasBtn.configure(command=self.DissasFile);

					self.DebugBtn = tk.Button(top)
					self.DebugBtn.place(relx=0.632, rely=0.0, height=24, width=57)
					self.DebugBtn.configure(activebackground="#ececec")
					self.DebugBtn.configure(activeforeground="#000000")
					self.DebugBtn.configure(background="#d9d9d9")
					self.DebugBtn.configure(disabledforeground="#a3a3a3")
					self.DebugBtn.configure(foreground="#000000")
					self.DebugBtn.configure(highlightbackground="#d9d9d9")
					self.DebugBtn.configure(highlightcolor="black")
					self.DebugBtn.configure(pady="0")
					self.DebugBtn.configure(text='''Debug''')
					self.DebugBtn.configure(command=self.DebugFile);
					
					
					self.BreakpointBtn = tk.Button(top)
					self.BreakpointBtn.place(relx=0.382, rely=0.0, height=24, width=87)
					self.BreakpointBtn.configure(activebackground="#ececec")
					self.BreakpointBtn.configure(activeforeground="#000000")
					self.BreakpointBtn.configure(background="#d9d9d9")
					self.BreakpointBtn.configure(disabledforeground="#a3a3a3")
					self.BreakpointBtn.configure(foreground="#000000")
					self.BreakpointBtn.configure(highlightbackground="#d9d9d9")
					self.BreakpointBtn.configure(highlightcolor="black")
					self.BreakpointBtn.configure(pady="0")
					self.BreakpointBtn.configure(text='''Breakpoint''')
					self.BreakpointBtn.configure(command=self.Breakpoint);

					self.RegBtn = tk.Button(top)
					self.RegBtn.place(relx=0.158, rely=0.0, height=24, width=67)
					self.RegBtn.configure(activebackground="#ececec")
					self.RegBtn.configure(activeforeground="#000000")
					self.RegBtn.configure(background="#d9d9d9")
					self.RegBtn.configure(disabledforeground="#a3a3a3")
					self.RegBtn.configure(foreground="#000000")
					self.RegBtn.configure(highlightbackground="#d9d9d9")
					self.RegBtn.configure(highlightcolor="black")
					self.RegBtn.configure(pady="0")
					self.RegBtn.configure(text='''Registers''')
					self.RegBtn.configure(command=self.RegFile);
					
					self.contBtn = tk.Button(top)
					self.contBtn.place(relx=0.487, rely=0.0, height=24, width=117)
					self.contBtn.configure(activebackground="#ececec")
					self.contBtn.configure(activeforeground="#000000")
					self.contBtn.configure(background="#d9d9d9")
					self.contBtn.configure(disabledforeground="#a3a3a3")
					self.contBtn.configure(foreground="#000000")
					self.contBtn.configure(highlightbackground="#d9d9d9")
					self.contBtn.configure(highlightcolor="black")
					self.contBtn.configure(pady="0")
					self.contBtn.configure(text='''Continue Execution''')
					self.contBtn.configure(command=self.contFile);

					self.StackBtn = tk.Button(top)
					self.StackBtn.place(relx=0.237, rely=0.0, height=24, width=57)
					self.StackBtn.configure(activebackground="#ececec")
					self.StackBtn.configure(activeforeground="#000000")
					self.StackBtn.configure(background="#d9d9d9")
					self.StackBtn.configure(disabledforeground="#a3a3a3")
					self.StackBtn.configure(foreground="#000000")
					self.StackBtn.configure(highlightbackground="#d9d9d9")
					self.StackBtn.configure(highlightcolor="black")
					self.StackBtn.configure(pady="0")
					self.StackBtn.configure(text='''Stack''')
					self.StackBtn.configure(command=self.StackFile);

					self.MemBtn = tk.Button(top)
					self.MemBtn.place(relx=0.303, rely=0.0, height=24, width=67)
					self.MemBtn.configure(activebackground="#ececec")
					self.MemBtn.configure(activeforeground="#000000")
					self.MemBtn.configure(background="#d9d9d9")
					self.MemBtn.configure(disabledforeground="#a3a3a3")
					self.MemBtn.configure(foreground="#000000")
					self.MemBtn.configure(highlightbackground="#d9d9d9")
					self.MemBtn.configure(highlightcolor="black")
					self.MemBtn.configure(pady="0")
					self.MemBtn.configure(text='''Memory''')
					self.MemBtn.configure(command=self.MemFile);

					self.menubar = tk.Menu(top,font="TkMenuFont",bg=_bgcolor,fg=_fgcolor)
					top.configure(menu = self.menubar)

					self.Registers = tk.Label(top)
					self.Registers.place(relx=0.696, rely=0.642, height=27, width=96)
					self.Registers.configure(activebackground="#f9f9f9")
					self.Registers.configure(activeforeground="black")
					self.Registers.configure(background="#d9d9d9")
					self.Registers.configure(disabledforeground="#a3a3a3")
					self.Registers.configure(foreground="#000000")
					self.Registers.configure(highlightbackground="#d9d9d9")
					self.Registers.configure(highlightcolor="black")
					self.Registers.configure(text='''Registers''')

					self.Stack = tk.Label(top)
					self.Stack.place(relx=0.732, rely=0.063, height=27, width=44)
					self.Stack.configure(activebackground="#f9f9f9")
					self.Stack.configure(activeforeground="black")
					self.Stack.configure(background="#d9d9d9")
					self.Stack.configure(disabledforeground="#a3a3a3")
					self.Stack.configure(foreground="#000000")
					self.Stack.configure(highlightbackground="#d9d9d9")
					self.Stack.configure(highlightcolor="black")
					self.Stack.configure(text='''Stack''')
					
					self.Clear = tk.Button(top)
					self.Clear.place(relx=0.882, rely=0.0, height=24, width=47)
					self.Clear.configure(activebackground="#ececec")
					self.Clear.configure(activeforeground="#000000")
					self.Clear.configure(background="#d9d9d9")
					self.Clear.configure(disabledforeground="#a3a3a3")
					self.Clear.configure(foreground="#000000")
					self.Clear.configure(highlightbackground="#d9d9d9")
					self.Clear.configure(highlightcolor="black")
					self.Clear.configure(pady="0")
					self.Clear.configure(text='''Clear''')
					self.Clear.configure(command=self.ClearFile);

					self.Label1 = tk.Label(top)
					self.Label1.place(relx=0.724, rely=0.373, height=22, width=54)
					self.Label1.configure(activebackground="#f9f9f9")
					self.Label1.configure(activeforeground="black")
					self.Label1.configure(background="#d9d9d9")
					self.Label1.configure(disabledforeground="#a3a3a3")
					self.Label1.configure(foreground="#000000")
					self.Label1.configure(highlightbackground="#d9d9d9")
					self.Label1.configure(highlightcolor="black")
					self.Label1.configure(text='''Memory''')

					self.Message1 = tk.Message(top)
					self.Message1.place(relx=0.211, rely=0.532, relheight=0.047
							, relwidth=0.079)
					self.Message1.configure(background="#d9d9d9")
					self.Message1.configure(foreground="#000000")
					self.Message1.configure(highlightbackground="#d9d9d9")
					self.Message1.configure(highlightcolor="black")
					self.Message1.configure(text='''Debug''')
					self.Message1.configure(width=60)

					self.Message2 = tk.Message(top)
					self.Message2.place(relx=0.197, rely=0.081, relheight=0.047
							, relwidth=0.117)
					self.Message2.configure(background="#d9d9d9")
					self.Message2.configure(foreground="#000000")
					self.Message2.configure(highlightbackground="#d9d9d9")
					self.Message2.configure(highlightcolor="black")
					self.Message2.configure(text='''Dissasemble''')
					self.Message2.configure(width=90)

					self.Display1 = tk.Text(top)
					self.Display1.place(relx=0.0, rely=0.117, relheight=0.403
							, relwidth=0.584)
					self.Display1.configure(background="white")
					self.Display1.configure(font="TkTextFont")
					self.Display1.configure(foreground="black")
					self.Display1.configure(highlightbackground="#d9d9d9")
					self.Display1.configure(highlightcolor="black")
					self.Display1.configure(insertbackground="black")
					self.Display1.configure(selectbackground="blue")
					self.Display1.configure(selectforeground="white")
					self.Display1.configure(wrap="word")

					self.Display2 = tk.Text(top)
					self.Display2.place(relx=0.0, rely=0.57, relheight=0.403, relwidth=0.584)

					self.Display2.configure(background="white")
					self.Display2.configure(font="TkTextFont")
					self.Display2.configure(foreground="black")
					self.Display2.configure(highlightbackground="#d9d9d9")
					self.Display2.configure(highlightcolor="black")
					self.Display2.configure(insertbackground="black")
					self.Display2.configure(selectbackground="blue")
					self.Display2.configure(selectforeground="white")
					self.Display2.configure(wrap="word")

					self.Display3 = tk.Text(top)
					self.Display3.place(relx=0.658, rely=0.138, relheight=0.223
							, relwidth=0.321)
					self.Display3.configure(background="white")
					self.Display3.configure(font="TkTextFont")
					self.Display3.configure(foreground="black")
					self.Display3.configure(highlightbackground="#d9d9d9")
					self.Display3.configure(highlightcolor="black")
					self.Display3.configure(insertbackground="black")
					self.Display3.configure(selectbackground="blue")
					self.Display3.configure(selectforeground="white")
					self.Display3.configure(wrap="word")

					self.Display4 = tk.Text(top)
					self.Display4.place(relx=0.658, rely=0.434, relheight=0.184
							, relwidth=0.336)
					self.Display4.configure(background="white")
					self.Display4.configure(font="TkTextFont")
					self.Display4.configure(foreground="black")
					self.Display4.configure(highlightbackground="#d9d9d9")
					self.Display4.configure(highlightcolor="black")
					self.Display4.configure(insertbackground="black")
					self.Display4.configure(selectbackground="blue")
					self.Display4.configure(selectforeground="white")
					self.Display4.configure(wrap="word")


					self.Display5 = tk.Text(top)
					self.Display5.place(relx=0.645, rely=0.708, relheight=0.265
							, relwidth=0.347)
					self.Display5.configure(background="white")
					self.Display5.configure(font="TkTextFont")
					self.Display5.configure(foreground="red")
					self.Display5.configure(highlightbackground="#d9d9d9")
					self.Display5.configure(highlightcolor="black")
					self.Display5.configure(insertbackground="black")
					self.Display5.configure(selectbackground="blue")
					self.Display5.configure(selectforeground="white")
					self.Display5.configure(wrap="word")

		if __name__ == '__main__':
			vp_start_gui()

else:
    # Re-run the program with admin rights
	ctypes.windll.shell32.ShellExecuteW(None, "runas", sys.executable, " ".join(sys.argv), None, 1)







